<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plant API Data</title>
</head>
<body>
  <h1>Plant API Data</h1>

  <label for="species">Select Species:</label>
  <select id="species">
    <option value="">-- Select Species --</option>
  </select>
  <img id="speciesImage" src="" alt="Species Image" style="max-width: 200px; max-height: 200px; display: none;">

  <label for="diseases">Select Disease:</label>
  <select id="diseases">
    <option value="">-- Select Disease --</option>
  </select>

  <div id="speciesDetailsContainer">
    <h2>Species Details</h2>
    <ul id="speciesDetails"></ul>
  </div>

  <script>
    // Fetch plant species data
    fetch('https://perenual.com/api/species-list?key=sk-kZSO66156adb022775047')
      .then(response => response.json())
      .then(responseData => {
        console.log('Species data:', responseData);
        const speciesData = responseData.data;
        const speciesDropdown = document.getElementById('species');
        speciesData.forEach(species => {
          const option = document.createElement('option');
          option.value = species.id;
          option.textContent = `${species.common_name} (${species.scientific_name})`;
          speciesDropdown.appendChild(option);
        });
      })
      .catch(error => console.error('Error fetching species:', error));

    // Fetch plant diseases data
    fetch('https://perenual.com/api/pest-disease-list?key=sk-kZSO66156adb022775047')
      .then(response => response.json())
      .then(responseData => {
        console.log('Diseases data:', responseData);
        const diseasesData = responseData.data;
        const diseasesDropdown = document.getElementById('diseases');
        diseasesData.forEach(disease => {
          const option = document.createElement('option');
          option.value = disease.id;
          option.textContent = disease.common_name;
          diseasesDropdown.appendChild(option);
        });
      })
      .catch(error => console.error('Error fetching diseases:', error));

    // Fetch and display image and species details when species is selected
    document.getElementById('species').addEventListener('change', function() {
      const speciesId = this.value;
      if (speciesId) {
        fetch(`https://perenual.com/api/species/details/${speciesId}?key=sk-kZSO66156adb022775047`)
          .then(response => response.json())
          .then(speciesDetails => {
            const speciesImage = document.getElementById('speciesImage');
            if (speciesDetails.image_url) {
              speciesImage.src = speciesDetails.image_url;
              speciesImage.style.display = 'block'; // Show the image
            } else {
              speciesImage.style.display = 'none'; // Hide the image if no URL is provided
            }

            // Populate species details
            const speciesDetailsContainer = document.getElementById('speciesDetails');
            speciesDetailsContainer.innerHTML = ''; // Clear previous details
            for (const key in speciesDetails) {
              if (speciesDetails.hasOwnProperty(key) && key !== 'image_url') {
                const li = document.createElement('li');
                li.textContent = `${key}: ${speciesDetails[key]}`;
                speciesDetailsContainer.appendChild(li);
              }
            }
          })
          .catch(error => console.error('Error fetching species details:', error));
      } else {
        // Hide the image when no species is selected
        document.getElementById('speciesImage').style.display = 'none';
      }
    });
  </script>
</body>
</html>
